<!DOCTYPE html>
<html lang="el">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Crisis Management Center of Attica â€“ ÎšÎ­Î½Ï„ÏÎ¿ Î”Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ·Ï‚ ÎšÏÎ¯ÏƒÎµÏ‰Î½ Î‘Ï„Ï„Î¹ÎºÎ®Ï‚</title>
<style>
body{
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,sans-serif;
  background:#0d1117;color:#e6eefc;margin:0;
}
header{
  background:#161b22;border-bottom:1px solid #30363d;
  padding:16px;position:sticky;top:0;z-index:10;
  display:flex;justify-content:space-between;align-items:center;
}
h1{margin:0;font-size:18px}
.container{max-width:1200px;margin:auto;padding:20px}
section{
  background:#1c222c;border:1px solid #30363d;border-radius:8px;
  padding:16px;margin-bottom:20px;
}
label{display:block;margin-top:10px;font-weight:600}
input,select,textarea{
  width:100%;padding:8px;border-radius:6px;border:1px solid #30363d;
  background:#0e1626;color:#fff;
}
button{
  cursor:pointer;background:#1f6feb;color:#fff;border:none;
  padding:10px 16px;margin-top:10px;border-radius:6px;
}
button:hover{background:#388bfd}
#map{height:400px;border-radius:8px;margin-top:10px}
table{width:100%;border-collapse:collapse;margin-top:10px}
th,td{border-bottom:1px solid #30363d;padding:8px;text-align:left}
th{background:#21262d}
footer{text-align:center;color:#888;padding:20px;font-size:13px}
.lang-select{
  background:#0e1626;color:#fff;border:1px solid #30363d;
  border-radius:6px;padding:5px
}
.icon{font-size:18px}
</style>
</head>

<body>
<header>
  <h1 id="siteTitle">ğŸ›¡ï¸ ÎšÎ­Î½Ï„ÏÎ¿ Î”Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ·Ï‚ ÎšÏÎ¯ÏƒÎµÏ‰Î½ Î‘Ï„Ï„Î¹ÎºÎ®Ï‚</h1>
  <select id="lang" class="lang-select" onchange="setLang(this.value)">
    <option value="el">ğŸ‡¬ğŸ‡· Î•Î»Î»Î·Î½Î¹ÎºÎ¬</option>
    <option value="en">ğŸ‡¬ğŸ‡§ English</option>
  </select>
</header>

<div class="container">
<section>
  <h2 id="addTitle">ğŸ“‹ ÎšÎ±Ï„Î±Ï‡ÏÏÎ¹ÏƒÎ· Î£Ï…Î¼Î²Î¬Î½Ï„Î¿Ï‚</h2>
  <form id="incidentForm">
    <label id="typeLabel">Î¤ÏÏ€Î¿Ï‚ ÏƒÏ…Î¼Î²Î¬Î½Ï„Î¿Ï‚:</label>
    <select id="type">
      <option>Î¦Ï…ÏƒÎ¹ÎºÎ® ÎšÎ±Ï„Î±ÏƒÏ„ÏÎ¿Ï†Î®</option>
      <option>Î§Î·Î¼Î¹ÎºÏŒ Î£Ï…Î¼Î²Î¬Î½</option>
      <option>Î’Î¹Î¿Î¼Î·Ï‡Î±Î½Î¹ÎºÏŒ Î‘Ï„ÏÏ‡Î·Î¼Î±</option>
      <option>Î†Î»Î»Î¿</option>
    </select>

    <label id="titleLabel">Î¤Î¯Ï„Î»Î¿Ï‚:</label>
    <input id="title" placeholder="Ï€.Ï‡. Î Ï…ÏÎºÎ±Î³Î¹Î¬ ÏƒÎµ Î´Î¬ÏƒÎ¿Ï‚">

    <label id="locLabel">Î¤Î¿Ï€Î¿Î¸ÎµÏƒÎ¯Î±:</label>
    <input id="location" placeholder="Ï€.Ï‡. ÎœÎ±ÏÎ±Î¸ÏÎ½Î±Ï‚">

    <label id="sevLabel">Î£Î¿Î²Î±ÏÏŒÏ„Î·Ï„Î±:</label>
    <select id="severity">
      <option>Î§Î±Î¼Î·Î»Î®</option>
      <option>ÎœÎµÏƒÎ±Î¯Î±</option>
      <option>Î¥ÏˆÎ·Î»Î®</option>
      <option>ÎšÏÎ¯ÏƒÎ¹Î¼Î·</option>
    </select>

    <label>ğŸ‘¥ Î‘ÏÎ¹Î¸Î¼ÏŒÏ‚ ÎœÎµÎ»ÏÎ½:</label>
    <input id="members" type="number" min="0" placeholder="Ï€.Ï‡. 5">

    <label>ğŸš’ Î‘ÏÎ¹Î¸Î¼ÏŒÏ‚ ÎŸÏ‡Î·Î¼Î¬Ï„Ï‰Î½:</label>
    <input id="vehicles" type="number" min="0" placeholder="Ï€.Ï‡. 2">

    <label>ğŸš— Î¤ÏÏ€Î¿Ï‚ ÎŸÏ‡Î®Î¼Î±Ï„Î¿Ï‚:</label>
    <select id="vehicletype">
      <option>Î‘ Î¤ÏÏ€Î¿Ï…</option>
      <option>Î’ Î¤ÏÏ€Î¿Ï…</option>
      <option>Î“ Î¤ÏÏ€Î¿Ï…</option>
      <option>Î” Î¤ÏÏ€Î¿Ï…</option>
      <option>Î¥Ï€Î¿ÏƒÏ„Î®ÏÎ¹Î¾Î·Ï‚</option>
    </select>

    <label id="descLabel">Î ÎµÏÎ¹Î³ÏÎ±Ï†Î® / Î•Î½Î­ÏÎ³ÎµÎ¹ÎµÏ‚:</label>
    <textarea id="details" rows="3" placeholder="Î ÎµÏÎ¹Î³ÏÎ±Ï†Î® ÏƒÏ…Î¼Î²Î¬Î½Ï„Î¿Ï‚..."></textarea>
    <button type="submit" id="saveBtn">â• ÎšÎ±Ï„Î±Ï‡ÏÏÎ¹ÏƒÎ·</button>
  </form>
  <div id="map"></div>
</section>
<section>
  <h2 id="tableTitle">ğŸ“œ Î£Ï…Î¼Î²Î¬Î½Ï„Î±</h2>
  <table id="incidentTable">
    <thead>
      <tr>
        <th>Î¤ÏÏ€Î¿Ï‚</th>
        <th>Î¤Î¯Ï„Î»Î¿Ï‚</th>
        <th>Î¤Î¿Ï€Î¿Î¸ÎµÏƒÎ¯Î±</th>
        <th>Î£Î¿Î²Î±ÏÏŒÏ„Î·Ï„Î±</th>
        <th>ğŸ‘¥ ÎœÎ­Î»Î·</th>
        <th>ğŸš’ ÎŸÏ‡Î®Î¼Î±Ï„Î±</th>
        <th>ğŸš— Î¤ÏÏ€Î¿Ï‚ ÎŸÏ‡Î®Î¼Î±Ï„Î¿Ï‚</th>
        <th>ğŸ•“ ÎÏÎ±</th>
        <th>ğŸ“¤ ÎšÎ¿Î¹Î½Î¿Ï€Î¿Î¯Î·ÏƒÎ·</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
  <div style="margin-top:10px">
    <button onclick="exportJSON()" id="expBtn">ğŸ’¾ Î•Î¾Î±Î³Ï‰Î³Î®</button>
    <button onclick="window.print()" id="printBtn">ğŸ–¨ï¸ Î•ÎºÏ„ÏÏ€Ï‰ÏƒÎ·</button>
    <button onclick="resetData()" id="resetBtn">â™»ï¸ Î•Ï€Î±Î½Î±Ï†Î¿ÏÎ¬</button>
  </div>
</section>

<section>
  <h2 id="notesTitle">ğŸ’¬ Î•Ï€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î± / Î£Î·Î¼ÎµÎ¹ÏÏƒÎµÎ¹Ï‚</h2>
  <textarea id="notes" rows="5"
            placeholder="Î“ÏÎ¬ÏˆÎµ ÎµÎ´Ï ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ­Ï‚ ÏƒÎ·Î¼ÎµÎ¹ÏÏƒÎµÎ¹Ï‚ Î® Î¼Î·Î½ÏÎ¼Î±Ï„Î± Î¿Î¼Î¬Î´Î±Ï‚..."></textarea>
  <button onclick="saveNotes()" id="notesBtn">Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· Î£Î·Î¼ÎµÎ¹ÏÏƒÎµÏ‰Î½</button>
</section>
</div>

<footer>
  Â© 2025 Crisis Management Center of Attica â€“ Î›ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯ Ï€Î»Î®ÏÏ‰Ï‚ offline
</footer>
<script>
/* ====== Î”Î™Î“Î›Î©Î£Î£Î™Î‘ ====== */
const strings = {
  el: {
    title: "ÎšÎ­Î½Ï„ÏÎ¿ Î”Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ·Ï‚ ÎšÏÎ¯ÏƒÎµÏ‰Î½ Î‘Ï„Ï„Î¹ÎºÎ®Ï‚",
    add: "ÎšÎ±Ï„Î±Ï‡ÏÏÎ¹ÏƒÎ· Î£Ï…Î¼Î²Î¬Î½Ï„Î¿Ï‚",
    events: "Î£Ï…Î¼Î²Î¬Î½Ï„Î±",
    contact: "Î•Ï€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î± / Î£Î·Î¼ÎµÎ¹ÏÏƒÎµÎ¹Ï‚",
    export: "Î•Î¾Î±Î³Ï‰Î³Î®",
    print: "Î•ÎºÏ„ÏÏ€Ï‰ÏƒÎ·",
    reset: "Î•Ï€Î±Î½Î±Ï†Î¿ÏÎ¬",
    notesSaved: "ÎŸÎ¹ ÏƒÎ·Î¼ÎµÎ¹ÏÏƒÎµÎ¹Ï‚ Î±Ï€Î¿Î¸Î·ÎºÎµÏÏ„Î·ÎºÎ±Î½.",
    confirmReset: "Î”Î¹Î±Î³ÏÎ±Ï†Î® ÏŒÎ»Ï‰Î½ Ï„Ï‰Î½ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½;",
    shareText: (t, l, ty, m, v, vt) =>
      `ğŸš¨ Î£Ï…Î¼Î²Î¬Î½: ${t}\nğŸ“ Î¤Î¿Ï€Î¿Î¸ÎµÏƒÎ¯Î±: ${l}\nğŸ•“ ${new Date().toLocaleString("el-GR")}\nğŸ§­ Î¤ÏÏ€Î¿Ï‚: ${ty}\nğŸ‘¥ ÎœÎ­Î»Î·: ${m}\nğŸš’ ÎŸÏ‡Î®Î¼Î±Ï„Î±: ${v} (${vt})`
  },
  en: {
    title: "Crisis Management Center of Attica",
    add: "Add Incident",
    events: "Incidents",
    contact: "Contact / Notes",
    export: "Export",
    print: "Print",
    reset: "Reset",
    notesSaved: "Notes saved.",
    confirmReset: "Delete all data?",
    shareText: (t, l, ty, m, v, vt) =>
      `ğŸš¨ Incident: ${t}\nğŸ“ Location: ${l}\nğŸ•“ ${new Date().toLocaleString("en-GB")}\nğŸ§­ Type: ${ty}\nğŸ‘¥ Members: ${m}\nğŸš’ Vehicles: ${v} (${vt})`
  }
};
let lang = localStorage.getItem("lang") || "el";
function setLang(l) {
  lang = l;
  localStorage.setItem("lang", l);
  document.getElementById("siteTitle").textContent = "ğŸ›¡ï¸ " + strings[l].title;
  document.getElementById("addTitle").textContent = "ğŸ“‹ " + strings[l].add;
  document.getElementById("tableTitle").textContent = "ğŸ“œ " + strings[l].events;
  document.getElementById("notesTitle").textContent = "ğŸ’¬ " + strings[l].contact;
  document.getElementById("expBtn").textContent = "ğŸ’¾ " + strings[l].export;
  document.getElementById("printBtn").textContent = "ğŸ–¨ï¸ " + strings[l].print;
  document.getElementById("resetBtn").textContent = "â™»ï¸ " + strings[l].reset;
}
setTimeout(() => {
  setLang(lang);
  document.getElementById("lang").value = lang;
}, 300);

/* ====== Î‘Î ÎŸÎ˜Î—ÎšÎ•Î¥Î£Î— / Î Î™ÎÎ‘ÎšÎ‘Î£ ====== */
const form = document.getElementById("incidentForm");
const tableBody = document.querySelector("#incidentTable tbody");
const notesEl = document.getElementById("notes");
let map, marker;

function loadIncidents() {
  const data = JSON.parse(localStorage.getItem("incidents") || "[]");
  data.forEach(addRow);
}
function addRow(item) {
  const tr = document.createElement("tr");
  const mapLink = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(item.location)}`;
  tr.innerHTML = `
    <td>${item.type}</td>
    <td>${item.title}</td>
    <td><a href="${mapLink}" target="_blank">${item.location}</a></td>
    <td>${item.severity}</td>
    <td>ğŸ‘¥ ${item.members}</td>
    <td>ğŸš’ ${item.vehicles}</td>
    <td>ğŸš— ${item.vehicletype}</td>
    <td>${item.time}</td>
    <td>
      <button onclick="shareIncident('${item.title}','${item.location}','${item.type}','${item.members}','${item.vehicles}','${item.vehicletype}')">ğŸ“¤</button>
      <a href="viber://forward?text=${encodeURIComponent(strings[lang].shareText(item.title,item.location,item.type,item.members,item.vehicles,item.vehicletype))}" target="_blank">ğŸ“²</a>
      <a href="fb-messenger://share/?link=${encodeURIComponent(mapLink)}" target="_blank">ğŸ’¬</a>
      <a href="https://wa.me/?text=${encodeURIComponent(strings[lang].shareText(item.title,item.location,item.type,item.members,item.vehicles,item.vehicletype))}" target="_blank">ğŸŸ¢</a>
      <form.addEventListener("submit", e => {
  e.preventDefault();
  const incident = {
    type: type.value,
    title: title.value,
    location: location.value,
    severity: severity.value,
    members: members.value,
    vehicles: vehicles.value,
    vehicletype: vehicletype.value,
    details: details.value,
    time: new Date().toLocaleString("el-GR")
  };
  addRow(incident);
  const data = JSON.parse(localStorage.getItem("incidents") || "[]");
  data.push(incident);
  localStorage.setItem("incidents", JSON.stringify(data));
  form.reset();
});